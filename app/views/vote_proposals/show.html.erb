<% content_for :header do %>
  <%= render partial: "header" %>
<% end %>

<div id="preview">
  <div class="inner">
    <div class="image fit">
      
    </div>
    <div class="content">
      <header>
	<h2><%= @current.topic %></h2 >
      </header>
      <p><%= @current.description %></p>
      <p>
        <% @current.vote_proposal_options.each do |option| %>
          <% css_class = "button big red" %>
          <% if @vote
            ind = @vote.vote_proposal_options.index(option)
            css_class += " voted" if ind && (ind >= 0) %>
            <% options = {
              vote: {
                vote_proposal_id: @current.id,
                vote_proposal_option_ids: [option.id]
              }
            }
            %>
            <%= link_to option.name, update_vote_path(options), remote: true, method: :put, class: "#{css_class}" %>          
          <% else %>
            <% options = {
               vote: {
                 vote_proposal_id: @current.id,
                 vote_proposal_option_ids: [option.id]
               }
             }
            %>
            <%= link_to option.name, create_vote_path(options), remote: true, method: :post, class: "#{css_class}" %>
          <% end %>
        <% end %>
      </p>
    </div>    
  </div>
  
  <% if @prev %>
    <%= link_to vote_proposal_path(@prev), class: "nav previous" do %>
      <span class="fa fa-chevron-left"></span>
    <% end %>
  <% end %>
  <% if @next %>
    <%= link_to vote_proposal_path(@next), class: "nav next" do %>
      <span class="fa fa-chevron-right"></span>
    <% end %>
  <% end %>
    
</div>
